
define double sigma 
!let sigma 7.530E-03                                                   !rms level
let sigma 21.2*7.530E-03
define double up 
!let up 23                                                        !the highest value
let up 80
set unit v
greg\pen /weight 1.75
set font duplex
set character 0.5
set plot histogram 


lut color
!LET LUT%HUE[I] = 16*INT((256-2*I)|16)
LET LUT%HUE[I] = 256*(1-(I/LUT%SIZE))                            !colourmap, e.g. LUT%BLUE/LUT%RED
lut lut


greg1\set plot landscape
set viewport 0.05 0.3 0.42 0.75
greg\set coord user
greg\set character 0.5
greg\pen /def

	 greg\column x 2 y 3 z 4 /file co21_int.txt    !colourmap file
    greg2\rgdata x y z /blank '3*sigma'   !blanking below 3sigma
    greg\limits /rgdata /reverse x
    greg\level '50*sigma' to up by '10*sigma'

    greg\plot /scaling lin '3*sigma' up /blanking '3*sigma' 0

let sigma 5*7.530E-03
    greg\pen /weight 2.75                                        !contours thickness
 	 greg\column x 2 y 3 z 4 /file co21_blue.txt    !contours file
    greg2\rgdata x y z /blank sigma
    greg\limits /rgdata /reverse x 
    greg\level '10*sigma' to up by '15*sigma'                    !contours levels

    greg\pen /colour 3                                           !contours colour [in range: 0-7]
    greg\rgmap /abs
let sigma 3.4*7.530E-03
    greg\pen /weight 2.75                                        !contours thickness
 	 greg\column x 2 y 3 z 4 /file co21_red.txt    !contours file
    greg2\rgdata x y z /blank sigma
    greg\limits /rgdata /reverse x 
    greg\level '10*sigma' to up by '15*sigma'                    !contours levels

    greg\pen /colour 1                                           !contours colour [in range: 0-7]
    greg\rgmap /abs


!axes
    greg\set character 0.3
    greg\pen /weight 0.75                                        !axes thickness
    greg\pen /colour 0
    greg\box n o i

    greg\set character 0.3
    greg\pen /colour 0
    greg\box p o i

    wedge top /scaling lin sigma up                              !show colourbar

    greg1\column /close



!outflows                                                        !draw line
    greg\pen /def
    greg\pen /colour 6 /weight 1    
    greg\draw relocate 102.75 -153.06 /user                      !line edge
    greg\draw line 106.5 -123.3 /user /clip                      !line the second edge
    greg\pen /def


greg\pen /colour 0 /weight 1                                     !set title and labels
greg\set character 0.4
greg\label "\GD\Gd (Arcsec) " /y
greg\label "\GD\Ga (Arcsec) " /x
    greg\set character 0.4
	greg\draw text 0 80 "Integrated intensity [K km/s]"
    greg\set character 0.6
	greg\draw text 0 90 "CO J=2-1"


sys "rm -f gy3_7_CO21_blue_red.eps"                                    !output file
hardcopy "gy3_7_CO21_blue_red.eps"
